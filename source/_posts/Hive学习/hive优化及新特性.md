---
layout: posts
title: hive优化及新特性
date: 2022-10-29 15:17:09
description: "这是文章开头，显示在主页面，详情请点击此处。"
categories: 
- "hive"
tags:
- "hive"
---

简介 <!--more-->
![截屏2022-03-19 16.07.25](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-19%2016.07.25-7026944.jpg)

![截屏2022-03-19 16.09.04](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-19%2016.09.04.jpg)

![截屏2022-03-19 16.09.34](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-19%2016.09.34.jpg)



# 表设计优化

![截屏2022-03-21 18.18.25](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-21%2018.18.25.jpg)

![截屏2022-03-21 18.21.46](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-21%2018.21.46.jpg)

![截屏2022-03-21 18.23.38](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-21%2018.23.38.jpg)

![截屏2022-03-21 18.24.04](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-21%2018.24.04.jpg)

![截屏2022-03-24 11.01.11](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.01.11.jpg)

![截屏2022-03-24 11.02.09](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.02.09.jpg)

![截屏2022-03-24 11.03.08](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.03.08.jpg)

不按join字段分桶，将毫无意义。

<img src="hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.11.45.jpg" alt="截屏2022-03-24 11.11.45" style="zoom:50%;" />

![截屏2022-03-24 11.14.05](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.14.05.jpg)

![截屏2022-03-24 11.15.02](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.15.02.jpg)

![截屏2022-03-24 11.17.40](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.17.40.jpg)

![截屏2022-03-24 11.19.36](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.19.36.jpg)

![截屏2022-03-24 11.20.20](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.20.20.jpg)

![截屏2022-03-24 11.20.51](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.20.51.jpg)

![截屏2022-03-24 11.23.49](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.23.49.jpg)



# 表数据优化

![截屏2022-03-24 11.50.02](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.50.02.jpg)



![截屏2022-03-24 11.25.16](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.25.16.jpg)

![截屏2022-03-24 11.26.34](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.26.34.jpg)

![截屏2022-03-24 11.36.31](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.36.31.jpg)

![截屏2022-03-24 11.37.34](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.37.34.jpg)

![截屏2022-03-24 11.38.26](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.38.26.jpg)

load 只是搬运数据，不改变数据结构，用orc格式或者别的什么格式，都用insert into加载。

![截屏2022-03-24 11.41.36](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.41.36.jpg)

![截屏2022-03-24 11.43.02](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.43.02.jpg)

![截屏2022-03-24 11.43.13](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.43.13.jpg)

![截屏2022-03-24 11.43.54](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.43.54.jpg)

![截屏2022-03-24 11.47.56](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.47.56.jpg)

![截屏2022-03-24 11.45.06](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.45.06.jpg)

![截屏2022-03-24 11.48.48](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.48.48.jpg)

![截屏2022-03-24 11.51.48](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.51.48.jpg)

![截屏2022-03-24 11.55.01](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.55.01.jpg)

![截屏2022-03-24 11.55.53](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.55.53.jpg)

![截屏2022-03-24 11.56.45](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.56.45.jpg)

![截屏2022-03-24 11.58.18](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2011.58.18.jpg)



# 任务执行优化

![截屏2022-03-24 12.06.48](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2012.06.48.jpg)



![截屏2022-03-24 12.04.22](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2012.04.22.jpg)

![截屏2022-03-24 12.05.38](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2012.05.38.jpg)

![截屏2022-03-24 12.05.46](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-24%2012.05.46.jpg)

![截屏2022-03-25 11.11.54](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.11.54.jpg)

![截屏2022-03-25 11.15.22](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.15.22.jpg)

![截屏2022-03-25 11.16.54](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.16.54.jpg)

![截屏2022-03-25 11.17.26](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.17.26.jpg)

![截屏2022-03-25 11.21.38](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.21.38.jpg)

![截屏2022-03-25 11.23.01](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.23.01.jpg)

![截屏2022-03-25 11.23.45](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.23.45.jpg)

​		减少笛卡尔积的好方法。

![截屏2022-03-25 11.24.50](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.24.50.jpg)

![截屏2022-03-25 11.25.10](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.25.10.jpg)

![截屏2022-03-25 11.28.30](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.28.30.jpg)

![截屏2022-03-25 11.28.50](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.28.50.jpg)

![截屏2022-03-25 11.30.26](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.30.26.jpg)

![截屏2022-03-25 11.31.59](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.31.59.jpg)

![截屏2022-03-25 11.33.00](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.33.00.jpg)

![截屏2022-03-25 11.39.08](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2011.39.08.jpg)

![截屏2022-03-25 16.36.53](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.36.53.jpg)

![截屏2022-03-25 16.39.04](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.39.04.jpg)

## 数据倾斜

​		![截屏2022-03-25 16.42.17](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.42.17.jpg)

![截屏2022-03-25 16.47.46](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.47.46.jpg)

![截屏2022-03-25 16.54.24](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.54.24.jpg)

![截屏2022-03-25 16.56.31](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.56.31.jpg)

![截屏2022-03-25 16.56.55](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.56.55.jpg)

![截屏2022-03-25 16.58.22](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.58.22.jpg)

![截屏2022-03-25 16.59.14](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2016.59.14.jpg)

# 新特性

![截屏2022-03-25 17.01.35](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2017.01.35.jpg)

不推荐再使用mapreduce引擎，推荐用spark。

![截屏2022-03-25 17.02.55](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2017.02.55.jpg)

​		DAG有向无环图

![截屏2022-03-25 17.04.55](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2017.04.55.jpg)

![截屏2022-03-25 17.07.10](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2017.07.10.jpg)

![截屏2022-03-25 17.08.07](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2017.08.07.jpg)

​		tez 引擎安装 集成到Hadoop和hive中，参考别的资料，这里就不再介绍了。

![截屏2022-03-25 17.12.33](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2017.12.33.jpg)

![截屏2022-03-25 17.15.09](hive%E4%BC%98%E5%8C%96%E5%8F%8A%E6%96%B0%E7%89%B9%E6%80%A7.assets/%E6%88%AA%E5%B1%8F2022-03-25%2017.15.09.jpg)

​		spark 好于 tez 好于 mapreduce。

​		独立于hive的metastore也可以安装部署，脱离hive自己运行的metastore，不做过多介绍。

