<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.13.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="这是文章开头，显示在主页面，详情请点击此处。">
<meta property="og:type" content="article">
<meta property="og:title" content="flask-study">
<meta property="og:url" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/index.html">
<meta property="og:site_name" content="Tiger_pop&#39;s Blog">
<meta property="og:description" content="这是文章开头，显示在主页面，详情请点击此处。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-04%2015.28.48.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-05%2010.13.52.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-05%2011.13.35.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-05%2020.41.25.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-06%2017.39.53.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-06%2020.23.45.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-07%2020.07.43.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-07%2020.46.56.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-07%2021.18.45.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-11%2010.42.45.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-11%2010.45.46.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-11%2010.46.38.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-11%2019.43.24.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-14%2019.49.26.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-06%2023.39.34.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2008.45.02.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2008.59.23.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2008.58.37.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2009.02.36.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2009.02.56.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2009.03.31.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2009.03.48.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-29%2009.35.45.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-29%2009.42.04.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-03-01%2010.56.21.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-08-25%2020.40.41.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-08-29%2020.07.25.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-09-10%2014.50.54.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-09-19%2014.47.35.jpg">
<meta property="og:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-09-19%2015.33.52.jpg">
<meta property="article:published_time" content="2025-05-20T02:21:02.000Z">
<meta property="article:modified_time" content="2025-05-21T13:25:00.615Z">
<meta property="article:author" content="陈宇韶chenyushao">
<meta property="article:tag" content="网络">
<meta property="article:tag" content="flask">
<meta property="article:tag" content="后端">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-04%2015.28.48.jpg">


<link rel="canonical" href="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/","path":"2025/05/20/网络学习/flask_study/","title":"flask-study"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>flask-study | Tiger_pop's Blog</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Tiger_pop's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Tiger_pop's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">tiger_pop 的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Flask%E6%95%B4%E4%BD%93%E6%A1%86%E6%9E%B6%E6%B5%81%E7%A8%8B"><span class="nav-number">1.</span> <span class="nav-text">Flask整体框架流程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E4%BE%8B%E5%AD%90"><span class="nav-number">1.1.</span> <span class="nav-text">简单例子</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E7%9A%84%E6%8B%86%E5%88%86"><span class="nav-number">2.</span> <span class="nav-text">项目的拆分</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1"><span class="nav-number">3.</span> <span class="nav-text">路由</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Flask%E8%AF%B7%E6%B1%82request-x2F-%E5%93%8D%E5%BA%94response"><span class="nav-number">4.</span> <span class="nav-text">Flask请求request&#x2F;响应response</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-number">5.</span> <span class="nav-text">重定向</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cookie%E5%AE%9E%E7%8E%B0"><span class="nav-number">6.</span> <span class="nav-text">cookie实现</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#session%E5%AE%9E%E7%8E%B0"><span class="nav-number">7.</span> <span class="nav-text">session实现</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#template"><span class="nav-number">8.</span> <span class="nav-text">template</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B"><span class="nav-number">9.</span> <span class="nav-text">模型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ORM"><span class="nav-number">9.1.</span> <span class="nav-text">ORM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">9.2.</span> <span class="nav-text">模型表操作</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%BE%E4%B9%A6%E9%A6%86%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE"><span class="nav-number">10.</span> <span class="nav-text">图书馆测试项目</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8"><span class="nav-number">11.</span> <span class="nav-text">插件使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%93%E5%AD%98%E4%BE%8B%E5%AD%90"><span class="nav-number">11.1.</span> <span class="nav-text">缓存例子</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%EF%BC%88%E9%92%A9%E5%AD%90%EF%BC%89"><span class="nav-number">12.</span> <span class="nav-text">中间件（钩子）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B"><span class="nav-number">12.1.</span> <span class="nav-text">切面编程</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#flask%E5%9B%9B%E5%A4%A7%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1"><span class="nav-number">13.</span> <span class="nav-text">flask四大内置对象</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95static%E5%92%8C%E6%A8%A1%E7%89%88%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95templates"><span class="nav-number">14.</span> <span class="nav-text">静态文件目录static和模版文件目录templates</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB"><span class="nav-number">15.</span> <span class="nav-text">前后端分离</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Flask%E7%B1%BB%E8%A7%86%E5%9B%BE%E5%92%8CRESTful"><span class="nav-number">16.</span> <span class="nav-text">Flask类视图和RESTful</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%97%E6%AE%B5%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%8F%8A%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="nav-number">17.</span> <span class="nav-text">字段格式化及参数解析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E9%83%A8%E5%88%86"><span class="nav-number">18.</span> <span class="nav-text">实验部分</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90"><span class="nav-number">18.1.</span> <span class="nav-text">项目分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="nav-number">18.2.</span> <span class="nav-text">数据库设计</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="陈宇韶chenyushao"
      src="/images/my.jpg">
  <p class="site-author-name" itemprop="name">陈宇韶chenyushao</p>
  <div class="site-description" itemprop="description">爱学习、爱工作、爱生活;         微信号: Tiger_and_master;         手机号码:18515678348 </div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">427</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">201</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my.jpg">
      <meta itemprop="name" content="陈宇韶chenyushao">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tiger_pop's Blog">
      <meta itemprop="description" content="爱学习、爱工作、爱生活;         微信号: Tiger_and_master;         手机号码:18515678348 ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="flask-study | Tiger_pop's Blog">
      <meta itemprop="description" content="这是文章开头，显示在主页面，详情请点击此处。">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          flask-study
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-05-20 10:21:02" itemprop="dateCreated datePublished" datetime="2025-05-20T10:21:02+08:00">2025-05-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-05-21 21:25:00" itemprop="dateModified" datetime="2025-05-21T21:25:00+08:00">2025-05-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">网络学习</span></a>
        </span>
    </span>

  
</div>

            <div class="post-description">这是文章开头，显示在主页面，详情请点击此处。</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Flask整体框架流程"><a href="#Flask整体框架流程" class="headerlink" title="Flask整体框架流程"></a>Flask整体框架流程</h1><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-04%2015.28.48.jpg" alt="截屏2024-01-04 15.28.48"></p>
<h2 id="简单例子"><a href="#简单例子" class="headerlink" title="简单例子"></a>简单例子</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 脚本 要以 app.py 命名。然后用 flask run。</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask </span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 路由装饰器 装饰一个 视图函数。</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;p&gt;Hello,world!&lt;/p&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/index&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index_test</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Index 页面&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 启动服务器</span></span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>



<p>建立一个项目，项目下由app.py、templates&#x2F;index.html、static&#x2F;index.css 组成。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="comment"># 脚本 要以 app.py 命名。然后用 flask run。</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, jsonify, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 路由装饰器 装饰一个 视图函数。</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;b&gt;Flask Home&lt;/b&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/index&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index_test</span>():</span><br><span class="line">    <span class="comment"># return &#x27;Index 页面2&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 模版渲染，所谓渲染就是 从后端找变量给前端填空。</span></span><br><span class="line">    <span class="comment"># 自动去templates下找 index.html。</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,name=<span class="string">&#x27;法外狂徒&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># json</span></span><br><span class="line">    <span class="comment"># return jsonify(&#123;&#x27;name&#x27;:&#x27;张三&#x27;,&#x27;age&#x27;:100&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 启动服务器</span></span><br><span class="line">    <span class="comment"># debug 开启调试模式，修改代码后，自动重启。</span></span><br><span class="line">    <span class="comment"># 端口可以自己指定，</span></span><br><span class="line">    <span class="comment"># 0.0.0.0 表示本机所有IP都能访问，包括本机局域网IP（可以让局域网都能访问）。</span></span><br><span class="line">    app.run(debug=<span class="literal">True</span>,port=<span class="number">5000</span>,host=<span class="string">&#x27;0.0.0.0&#x27;</span>) </span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- &lt;link rel=&quot;stylesheet&quot; href=&quot;../static/index.css&quot;&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;,filename=&#x27;index.css&#x27;)&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Index<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>name: &#123;&#123; name &#125;&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-tag">h4</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-05%2010.13.52.jpg" alt="截屏2024-01-05 10.13.52"></p>
<p>​		注意上面的 <code>app = Flask(__name__)</code> 是在 “第一个flask项目” 下创建的，app对象实际上的执行 是发生在“第一个flask项目”下的。</p>
<h1 id="项目的拆分"><a href="#项目的拆分" class="headerlink" title="项目的拆分"></a>项目的拆分</h1><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-05%2011.13.35.jpg" alt="截屏2024-01-05 11.13.35"></p>
<p>直接从App包 下调用 <strong>init</strong>.py 中的方法创建app对象就 好了。一个 App 就是一个 flask 应用。</p>
<p>app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接从App包 下调用 __init__.py 中的方法创建app对象就 好了。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> App <span class="keyword">import</span> create_app </span><br><span class="line"></span><br><span class="line">app = create_app()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>App&#x2F; <strong>init</strong> .py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入上一层级的 App 的包的时候，这个 __init__.py自动执行</span></span><br><span class="line"><span class="comment"># 一个 App 就是一个 flask 应用。</span></span><br><span class="line"><span class="comment"># 注意不要循环导入，这里统一外部向 __init__ 导入；</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask </span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> blue </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不必每一次 导入app包都新建一个 app 对象，所以封装进方法等待调用。jdong</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_app</span>():</span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 给app对象 注册 blue蓝图，把他们关联上。</span></span><br><span class="line">    app.register_blueprint(blueprint=blue)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> app </span><br></pre></td></tr></table></figure>

<p>App&#x2F;views.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint </span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line">blue2 = Blueprint(<span class="string">&#x27;product&#x27;</span>,__name__) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 给蓝图对象加上 路由；</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@blue2.route(<span class="params"><span class="string">&#x27;/goods&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;goods&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h1><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-05%2020.41.25.jpg" alt="截屏2024-01-05 20.41.25"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># views.py 下补充 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 路由参数</span></span><br><span class="line"><span class="comment"># string </span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/string/&lt;string:name&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_string</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(name)) </span><br><span class="line">    <span class="keyword">return</span> name</span><br><span class="line"><span class="comment"># int</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/int/&lt;int:age&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_int</span>(<span class="params">age</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(age)) </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(age) </span><br><span class="line"><span class="comment"># uuid</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/getuuid&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_uuid2</span>():</span><br><span class="line">    <span class="keyword">import</span> uuid </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/uuid/&lt;uuid:id&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_uuid</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">id</span>)) </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(<span class="built_in">id</span>) </span><br><span class="line"><span class="comment"># any</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/any/&lt;any(apple,orange,banana):id&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_any</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">id</span>)) </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(<span class="built_in">id</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># method : 请求方式 默认 get请求</span></span><br><span class="line"><span class="comment"># 如果要 get 和 post 都支持，需要改写一下。</span></span><br><span class="line"><span class="comment"># http状态码 1XX 成功一部分；2XX成功；3XX重定向；4XX客户端错误；5XX服务端错误。</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/methods&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_methods</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;methods&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># spider.py </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests </span><br><span class="line"></span><br><span class="line"><span class="comment"># get 请求</span></span><br><span class="line">res = requests.get(<span class="string">&#x27;http://127.0.0.1:5000/methods&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># post 请求</span></span><br><span class="line">res = requests.post(<span class="string">&#x27;http://127.0.0.1:5000/methods&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>



<h1 id="Flask请求request-x2F-响应response"><a href="#Flask请求request-x2F-响应response" class="headerlink" title="Flask请求request&#x2F;响应response"></a>Flask请求request&#x2F;响应response</h1><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-06%2017.39.53.jpg" alt="截屏2024-01-06 17.39.53"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, Response,jsonify, render_template,request</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line">blue1 = Blueprint(<span class="string">&#x27;product1&#x27;</span>,__name__) </span><br><span class="line">blue2 = Blueprint(<span class="string">&#x27;product2&#x27;</span>,__name__) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端向 服务端 发送请求</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/request/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_request</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;look here ! this is:&#x27;</span>,request)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 重要属性</span></span><br><span class="line">    <span class="built_in">print</span>(request.method)<span class="comment"># &#x27;get&#x27; &#x27;post&#x27; ...</span></span><br><span class="line">    <span class="built_in">print</span>(request.args)  <span class="comment"># 获取 GET 请求的参数</span></span><br><span class="line">    <span class="built_in">print</span>(request.args.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(request.form)  <span class="comment"># 获取 POST 请求的参数</span></span><br><span class="line">    <span class="built_in">print</span>(request.form.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(request.cookies)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;request ok!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># response 服务端 向 客户端发送响应</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/response/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_response</span>():</span><br><span class="line">    <span class="keyword">pass</span> </span><br><span class="line">    <span class="comment"># 响应的几种方式</span></span><br><span class="line">    <span class="comment"># 1.返回字符串 return &#x27;response is ok!&#x27;</span></span><br><span class="line">    <span class="comment"># 2.模版渲染,需要渲染相应的html文件.     </span></span><br><span class="line">    <span class="comment"># return render_template(&#x27;index.html&#x27;,name=&#x27;zs&#x27;,age=100)</span></span><br><span class="line">    <span class="comment"># 3.返回json数据。</span></span><br><span class="line">    <span class="comment"># data = &#123;&#x27;name&#x27;:&#x27;李四&#x27;,&#x27;age&#x27;:100&#125;</span></span><br><span class="line">    <span class="comment"># # return data </span></span><br><span class="line">    <span class="comment"># return jsonify(data) # 序列化一下，把字典变成str。</span></span><br><span class="line">    <span class="comment"># 4.自定义response对象。</span></span><br><span class="line">    html = render_template(<span class="string">&#x27;index.html&#x27;</span>,name=<span class="string">&#x27;小城&#x27;</span>,age=<span class="number">100</span>)</span><br><span class="line">    <span class="built_in">print</span>(html,<span class="built_in">type</span>(html))    </span><br><span class="line">    res = Response(html)</span><br><span class="line">    <span class="keyword">return</span> res </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests </span><br><span class="line"><span class="comment"># 模拟前端的请求。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get 请求 ?后加参数。</span></span><br><span class="line">res = requests.get(<span class="string">&#x27;http://127.0.0.1:5000/request/?name=lisi&amp;name=zhangsan&amp;age=22&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># post 请求 字典形式加参数。</span></span><br><span class="line">res = requests.post(<span class="string">&#x27;http://127.0.0.1:5000/request/&#x27;</span>,</span><br><span class="line">                    data=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;lucy&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">33</span>&#125;,</span><br><span class="line">                    cookies=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;hello&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上面代码 模拟发送了两次请求，每一个请求都会触发一次 view.py中的request方法。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- &lt;link rel=&quot;stylesheet&quot; href=&quot;../static/index.css&quot;&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;,filename=&#x27;index.css&#x27;)&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Index<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>name: &#123;&#123; name &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>age: &#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, Response,jsonify, redirect, render_template,request, url_for</span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line">blue1 = Blueprint(<span class="string">&#x27;product1&#x27;</span>,__name__) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端向 服务端 发送请求</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/request/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_request</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;look here ! this is:&#x27;</span>,request)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 重要属性</span></span><br><span class="line">    <span class="built_in">print</span>(request.method)<span class="comment"># &#x27;get&#x27; &#x27;post&#x27; ...</span></span><br><span class="line">    <span class="built_in">print</span>(request.args)  <span class="comment"># 获取 GET 请求的参数</span></span><br><span class="line">    <span class="built_in">print</span>(request.args.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(request.form)  <span class="comment"># 获取 POST 请求的参数</span></span><br><span class="line">    <span class="built_in">print</span>(request.form.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(request.cookies)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;request ok!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># response 服务端 向 客户端发送响应</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/response/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_response</span>():</span><br><span class="line">    <span class="keyword">pass</span> </span><br><span class="line">    <span class="comment"># 响应的几种方式</span></span><br><span class="line">    <span class="comment"># 1.返回字符串 return &#x27;response is ok!&#x27;</span></span><br><span class="line">    <span class="comment"># 2.模版渲染,需要渲染相应的html文件.     </span></span><br><span class="line">    <span class="comment"># return render_template(&#x27;index.html&#x27;,name=&#x27;zs&#x27;,age=100)</span></span><br><span class="line">    <span class="comment"># 3.返回json数据。</span></span><br><span class="line">    <span class="comment"># data = &#123;&#x27;name&#x27;:&#x27;李四&#x27;,&#x27;age&#x27;:100&#125;</span></span><br><span class="line">    <span class="comment"># # return data </span></span><br><span class="line">    <span class="comment"># return jsonify(data) # 序列化一下，把字典变成str。</span></span><br><span class="line">    <span class="comment"># 4.自定义response对象。</span></span><br><span class="line">    html = render_template(<span class="string">&#x27;index.html&#x27;</span>,name=<span class="string">&#x27;小城&#x27;</span>,age=<span class="number">100</span>)</span><br><span class="line">    <span class="built_in">print</span>(html,<span class="built_in">type</span>(html))    </span><br><span class="line">    res = Response(html)</span><br><span class="line">    <span class="keyword">return</span> res </span><br><span class="line"></span><br><span class="line"><span class="comment"># Redirect 重定向</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/redirect&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_redirect</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># 1.</span></span><br><span class="line">    <span class="comment"># return redirect(&#x27;https://www.qq.com&#x27;) # 重定向到外部网站。</span></span><br><span class="line">    <span class="comment"># 2.</span></span><br><span class="line">    <span class="comment"># return redirect(&#x27;/response/&#x27;) # 重定向到本地path路径，可能会触发路由修饰器的 视图函数。</span></span><br><span class="line">    <span class="comment"># 3.</span></span><br><span class="line">    <span class="comment"># 反向解析 url_for 通过视图函数 反过来找到 路由。</span></span><br><span class="line">    <span class="comment"># url_for(&#x27;蓝图名称.视图函数名&#x27;) 注意是蓝图名称，不是蓝图对象。</span></span><br><span class="line">    ret = url_for(<span class="string">&#x27;user.get_response&#x27;</span>,) <span class="comment"># ret 其实是路由 path。</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ret is:&#x27;</span>,ret) <span class="comment"># 打印 ret is: /response/</span></span><br><span class="line">    <span class="comment"># url_for的重定向是能够传参的。</span></span><br><span class="line">    ret2 = url_for(<span class="string">&#x27;user.get_request&#x27;</span>,name=<span class="string">&#x27;张飞&#x27;</span>,age=<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(ret2)</span><br></pre></td></tr></table></figure>



<h1 id="cookie实现"><a href="#cookie实现" class="headerlink" title="cookie实现"></a>cookie实现</h1><p>​		cookie的记忆是基于用户而不是浏览器；<img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-06%2020.23.45.jpg" alt="截屏2024-01-06 20.23.45"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-07%2020.07.43.jpg" alt="截屏2024-01-07 20.07.43"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># views.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, redirect, render_template, request</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 首页</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/home/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="comment"># 4. 获取 cookie</span></span><br><span class="line">    username = request.cookies.get(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;/home.html&#x27;</span>,username=username)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 登录</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="comment"># GET 访问登录页面</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">pass</span> </span><br><span class="line">        <span class="comment"># 1.获取前端提交过来的数据</span></span><br><span class="line">        username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password = request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        <span class="comment"># 2.模拟登录，验证用户名密码</span></span><br><span class="line">        <span class="keyword">if</span> username==<span class="string">&#x27;chen&#x27;</span> <span class="keyword">and</span> password==<span class="string">&#x27;123&#x27;</span>:</span><br><span class="line">            <span class="comment"># success  则重定向到 home 中</span></span><br><span class="line">            response = redirect(<span class="string">&#x27;/home&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(response,<span class="string">&#x27;look here&#x27;</span>)</span><br><span class="line">            <span class="comment"># 3. 设置 cookie ，cookie中不能有中文。</span></span><br><span class="line">            response.set_cookie(<span class="string">&#x27;user&#x27;</span>,username,max_age=<span class="number">3600</span>*<span class="number">24</span>*<span class="number">7</span>)</span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;用户名或密码错误&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注销</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    response = redirect(<span class="string">&#x27;/home&#x27;</span>)</span><br><span class="line">    <span class="comment"># 5.删除cookie</span></span><br><span class="line">    response.delete_cookie(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- /home.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- &lt;link rel=&quot;stylesheet&quot; href=&quot;../static/index.css&quot;&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;,filename=&#x27;index.css&#x27;)&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &#123;% if username %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            当前用户是:&#123;&#123;username&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/logout&quot;</span>&gt;</span>注销<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/login&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 注意要避免前端跳前端，那样会数据渲染不了,一定要经过后端。 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- /login 的路径在后端有对应的处理，那么就说明点击链接时涉及到后端路由。</span></span><br><span class="line"><span class="comment">        否则，可能是前端路由或者直接的页面跳转。 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;a href=&quot;/login&quot;&gt;登录&lt;/a&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- /login.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- &lt;link rel=&quot;stylesheet&quot; href=&quot;../static/index.css&quot;&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;,filename=&#x27;index.css&#x27;)&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 登录表格 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;  写法1 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;&#123;url_for(&#x27;user.login&#x27;)&#125;&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span> <span class="comment">&lt;!-- 写法2 用反向解析 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            用户名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            密码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="session实现"><a href="#session实现" class="headerlink" title="session实现"></a>session实现</h1><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-07%2020.46.56.jpg" alt="截屏2024-01-07 20.46.56"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-07%2021.18.45.jpg" alt="截屏2024-01-07 21.18.45"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># views.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, redirect, render_template, request, session</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 首页</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/home/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="comment">#  获取 session</span></span><br><span class="line">    username = session.get(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;/home.html&#x27;</span>,username=username)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 登录</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="comment"># GET 访问登录页面</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">pass</span> </span><br><span class="line">        <span class="comment"># 1.获取前端提交过来的数据</span></span><br><span class="line">        username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password = request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        <span class="comment"># 2.模拟登录，验证用户名密码</span></span><br><span class="line">        <span class="keyword">if</span> username==<span class="string">&#x27;chen&#x27;</span> <span class="keyword">and</span> password==<span class="string">&#x27;123&#x27;</span>:</span><br><span class="line">            response = redirect(<span class="string">&#x27;/home/&#x27;</span>)</span><br><span class="line">            <span class="comment"># 设置 session </span></span><br><span class="line">            session[<span class="string">&#x27;user&#x27;</span>] = username </span><br><span class="line">            session.permanent = <span class="literal">True</span> </span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;用户名或密码错误&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注销</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    response = redirect(<span class="string">&#x27;/home&#x27;</span>)</span><br><span class="line">    <span class="comment"># 删除 session</span></span><br><span class="line">    session.pop(<span class="string">&#x27;user&#x27;</span>)  </span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># __init__.py</span></span><br><span class="line"><span class="comment"># 导入上一层级的 App 的包的时候，这个 __init__.py自动执行</span></span><br><span class="line"><span class="comment"># 一个 App 就是一个 flask 应用。</span></span><br><span class="line"><span class="comment"># 注意不要循环导入，这里统一外部向 __init__ 导入；</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask </span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> blue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不必每一次 导入app包都新建一个 app 对象，所以封装进方法等待调用。jdong</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_app</span>():</span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 给app对象 注册 blue蓝图，把他们关联上。</span></span><br><span class="line">    app.register_blueprint(blueprint=blue)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># session 配置</span></span><br><span class="line">    <span class="built_in">print</span>(app.config)</span><br><span class="line">    app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;123&#x27;</span> <span class="comment"># 对称加密</span></span><br><span class="line">    app.config[<span class="string">&#x27;PERMANENT_SESSION_LIFETIME&#x27;</span>] = datetime.timedelta(days=<span class="number">8</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> app </span><br></pre></td></tr></table></figure>



<h1 id="template"><a href="#template" class="headerlink" title="template"></a>template</h1><p>Flask 使用 jinja2模版引擎。</p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-11%2010.42.45.jpg" alt="截屏2024-01-11 10.42.45"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-11%2010.45.46.jpg" alt="截屏2024-01-11 10.45.46"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-11%2010.46.38.jpg" alt="截屏2024-01-11 10.46.38"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-11%2019.43.24.jpg" alt="截屏2024-01-11 19.43.24"></p>
<p>view.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, render_template </span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">pass</span> </span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;ikun ikun ikun&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;age&#x27;</span>:<span class="number">7</span>,</span><br><span class="line">        <span class="string">&#x27;likes&#x27;</span>:[<span class="string">&#x27;ball&#x27;</span>,<span class="string">&#x27;sing&#x27;</span>,<span class="string">&#x27;dance&#x27;</span>,<span class="string">&#x27;code&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># return render_template(&#x27;home.html&#x27;,**data)</span></span><br><span class="line">    <span class="comment"># return render_template(&#x27;base.html&#x27;)</span></span><br><span class="line">    <span class="comment"># return render_template(&#x27;child1.html&#x27;)</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;child2.html&#x27;</span>,**data)</span><br></pre></td></tr></table></figure>

<p>home.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    &#123;# 模版语言的注释 #&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>变量:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>name:&#123;&#123; name &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>age:&#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>likes:&#123;&#123;likes&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>标签:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span>&gt;</span>if语句<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    &#123;% if age &gt;= 18 %&#125; </span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;name&#125;&#125;已经成年了<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    &#123;% elif age&gt;=6 %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>可以上学了<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;name&#125;&#125;还是小孩<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;  </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span>&gt;</span>for循环<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    &#123;% for like in likes %&#125;</span><br><span class="line">        &#123;% if loop.first %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color:red;&quot;</span>&gt;</span>&#123;&#123;like&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        &#123;% elif loop.last %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color:blue;&quot;</span>&gt;</span>&#123;&#123;like&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;like&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;  </span><br><span class="line">        index:&#123;&#123; loop.index &#125;&#125;</span><br><span class="line">        index2:&#123;&#123; loop.index0 &#125;&#125;</span><br><span class="line">        revindex:&#123;&#123; loop.revindex &#125;&#125;</span><br><span class="line">        revindex0:&#123;&#123; loop.revindex0 &#125;&#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>base.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>父模版<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &#123;# 在html的head中导入css文件，static中 #&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123;url_for(&#x27;static&#x27;,filename=&#x27;css/base.css&#x27;)&#125;&#125;&quot;</span>&gt;</span>        </span><br><span class="line">    &#123;% block extcss %&#125;</span><br><span class="line">    &#123;% endblock %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    &#123;% block head %&#125;</span><br><span class="line">    &#123;% endblock %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    &#123;% block content %&#125;</span><br><span class="line">    &#123;% endblock %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    &#123;% block foot %&#125;</span><br><span class="line">    &#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">    &#123;# 导入js文件，static中 #&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;url_for(&#x27;static&#x27;,filename=&#x27;js/base.js&#x27;)&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    &#123;% block extjs %&#125;</span><br><span class="line">    &#123;% endblock %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>child1.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;base.html&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block head %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>ok,ok,ok.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>

<p>child2.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &#x27;child1.html&#x27; %&#125; &#123;# 继承 #&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block head %&#125;</span><br><span class="line">    &#123;&#123; super() &#125;&#125; &#123;# 保留父辈block head内容 #&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>python<span class="tag">&lt;/<span class="name">p</span>&gt;</span> &#123;# 如果没有super就,覆盖重写了 #&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">    &#123;% include &#x27;child2_include.html&#x27; %&#125; &#123;# 导入include内容 #&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Flask content <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 宏定义 ： python的函数 --&gt;</span></span><br><span class="line">&#123;% macro person(name,age) %&#125;    </span><br><span class="line">    <span class="tag">&lt;<span class="name">b</span>&gt;</span>姓名 : &#123;&#123;name&#125;&#125;, 年龄 : &#123;&#123;age&#125;&#125; <span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">&#123;% endmacro %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block foot %&#125;</span><br><span class="line">    &#123;&#123; person(&#x27;小鸟&#x27;,100) &#125;&#125;</span><br><span class="line">    </span><br><span class="line">    &#123;# 过滤器 #&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;name | capitalize &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;name | title &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;name | upper &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;name | upper | first |lower &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>

<p>child2_include.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是child2中include的内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h1><h2 id="ORM"><a href="#ORM" class="headerlink" title="ORM"></a>ORM</h2><p>object relational mapping 对象关系映射；</p>
<p>数据库的表 映射到对象，对对象操作。 </p>
<p><code>pip install flask-sqlalchemy  pip install flask-migrate   pip install pymysql</code></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-01-14%2019.49.26.jpg" alt="截屏2024-01-14 19.49.26"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  __init__.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入上一层级的 App 的包的时候，这个 __init__.py自动执行</span></span><br><span class="line"><span class="comment"># 一个 App 就是一个 flask 应用。</span></span><br><span class="line"><span class="comment"># 注意不要循环导入，这里统一外部向 __init__ 导入；</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask </span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> blue</span><br><span class="line"><span class="keyword">from</span> .exts <span class="keyword">import</span> init_exit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不必每一次 导入app包都新建一个 app 对象，所以封装进方法等待调用。jdong</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_app</span>():</span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 给app对象 注册 blue蓝图，把他们关联上。</span></span><br><span class="line">    app.register_blueprint(blueprint=blue)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 配置数据库</span></span><br><span class="line">    db_uri = <span class="string">&#x27;sqlite:///sqlite3.db&#x27;</span></span><br><span class="line">    app.config[<span class="string">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = db_uri <span class="comment"># 配置数据库路径</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 把 插件和app关联上</span></span><br><span class="line">    init_exit(app=app)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> app </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exts.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># exts.py 插件管理</span></span><br><span class="line"><span class="comment"># 扩展的第三方插件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.导入第三方插件。</span></span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">from</span> flask_migrate <span class="keyword">import</span> Migrate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.初始化。</span></span><br><span class="line">db = SQLAlchemy()    <span class="comment"># ORM (让类变成模型)</span></span><br><span class="line">migrate = Migrate()  <span class="comment"># 数据迁移 (让模型变成表)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.和app对象绑定。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_exit</span>(<span class="params">app</span>):</span><br><span class="line">    db.init_app(app=app)</span><br><span class="line">    migrate.init_app(app=app,db=db)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># models.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .exts <span class="keyword">import</span> db </span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型中的 （对应）   数据库中的</span></span><br><span class="line"><span class="comment"># 类        --&gt;     表</span></span><br><span class="line"><span class="comment"># 类属性     --&gt;     表的字段</span></span><br><span class="line"><span class="comment"># 对象       --&gt;     表中的一行数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型 (就是一个继承了db.Model的类)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(db.Model):</span><br><span class="line">    <span class="comment"># 表名</span></span><br><span class="line">    __tablename__ = <span class="string">&#x27;tb_user&#x27;</span></span><br><span class="line">    <span class="comment"># 定义表的字段 </span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer,primary_key=<span class="literal">True</span>,autoincrement=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">30</span>),unique=<span class="literal">True</span>,index=<span class="literal">True</span>)</span><br><span class="line">    age = db.Column(db.Integer,default=<span class="number">1</span>)</span><br><span class="line">    sex = db.Column(db.Boolean,default=<span class="literal">True</span>)</span><br><span class="line">    salary = db.Column(db.Float,default=<span class="number">1000000000</span>,nullable=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># views.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint </span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> * </span><br><span class="line"><span class="comment"># 通过导入models模块，让models模块执行，间接让exits模块执行，也就有了db。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给蓝图对象加上 路由；</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;home&#x27;</span> </span><br><span class="line"><span class="comment"># 路由参数</span></span><br><span class="line"><span class="comment"># string </span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/string/&lt;string:name&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_string</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(name)) </span><br><span class="line">    <span class="keyword">return</span> name</span><br></pre></td></tr></table></figure>

<p>进入 app.py 文件夹所在的目录，执行</p>
<p><code>flask db init（创建迁移文件夹migrates;只调用一次）  </code><br><code>flask db migrate (生成迁移文件;自动搜索继承了db.Model的类) </code><br><code>flask db upgrade (把类都转换成表)  </code><br><code>flask db downgrade (撤回把类都转换成表)</code></p>
<p>每一次执行 <code>flask db migrate</code> 都会在migrations&#x2F;versions 中生成新的py文件，在表格变动的时候记得生成，然后 再 upgrade 变成表，在instance 下的db文件可见这些表。</p>
<p>注意：</p>
<p>Flask使用migrate迁移后，无法检测到models，无法生成表，则 <em><strong>*只需要在 app.py 中导入 models.py 中的类即可。*</strong></em></p>
<h2 id="模型表操作"><a href="#模型表操作" class="headerlink" title="模型表操作"></a>模型表操作</h2><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-06%2023.39.34.jpg" alt="截屏2024-02-06 23.39.34"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># view.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> and_</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, render_template, request</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> desc </span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line">blue1 = Blueprint(<span class="string">&#x27;product1&#x27;</span>,__name__) </span><br><span class="line">blue2 = Blueprint(<span class="string">&#x27;product2&#x27;</span>,__name__) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 给蓝图对象加上 路由；</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/useradd&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_add</span>():</span><br><span class="line">    u = User()</span><br><span class="line">    u.name = <span class="string">&#x27;kun&#x27;</span></span><br><span class="line">    u.age = <span class="number">24</span> </span><br><span class="line">    db.session.add(u)   <span class="comment"># u对象添加到session中。</span></span><br><span class="line">    db.session.commit() <span class="comment"># 同步到数据库中.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;success!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/useradds&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_adds</span>():</span><br><span class="line">    users = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>,<span class="number">30</span>):</span><br><span class="line">        u = User()</span><br><span class="line">        u.name = <span class="string">&#x27;斌斌&#x27;</span> + <span class="built_in">str</span>(i)</span><br><span class="line">        u.age = i </span><br><span class="line">        users.append(u)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        db.session.add_all(users)</span><br><span class="line">        db.session.commit() <span class="comment"># 事物提交</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        db.session.rollback() <span class="comment"># 回滚</span></span><br><span class="line">        db.session.flush() <span class="comment"># 清空缓存</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;fail !&#x27;</span> + <span class="built_in">str</span>(e)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;success !!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/userdel&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_del</span>():</span><br><span class="line">    u = User.query.first()  <span class="comment"># 先查到，再删除。</span></span><br><span class="line">    db.session.delete(u)</span><br><span class="line">    db.session.commit()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;success !&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/userupdate&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_update</span>():</span><br><span class="line">    u = User.query.first()  <span class="comment"># 先查到，再删除。</span></span><br><span class="line">    u.age = <span class="number">1000</span></span><br><span class="line">    db.session.commit()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;success !&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/userget/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_get</span>():</span><br><span class="line">    users = User.query.<span class="built_in">all</span>()</span><br><span class="line">    <span class="comment"># print(users) # class &#x27;list&#x27;</span></span><br><span class="line">    <span class="comment"># print(User.query) # 查询语句</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># filter()</span></span><br><span class="line">    users = User.query.<span class="built_in">filter</span>()</span><br><span class="line">    <span class="comment"># print(users,type(users)) # 查询集,可以不停的 filter再filter.</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># get()</span></span><br><span class="line">    user = User.query.get(<span class="number">8</span>)</span><br><span class="line">    <span class="comment"># print(user,type(user)) # user 对象.</span></span><br><span class="line">    <span class="comment"># print(user.name,user.age)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># filter()</span></span><br><span class="line">    users = User.query.<span class="built_in">filter</span>(User.age==<span class="number">20</span>)</span><br><span class="line">    users = User.query.filter_by(age=<span class="number">20</span>)</span><br><span class="line">    users = User.query.<span class="built_in">filter</span>(User.age&gt;<span class="number">20</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(users))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># limit() 前几条</span></span><br><span class="line">    <span class="comment"># offset() 跳过前几条</span></span><br><span class="line">    users = User.query.offset(<span class="number">3</span>).limit(<span class="number">4</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(users))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># order by </span></span><br><span class="line">    users = User.query.order_by(<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line">    users = User.query.order_by(desc(<span class="string">&#x27;age&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(users))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 逻辑运算</span></span><br><span class="line">    users = User.query.<span class="built_in">filter</span>(and_(User.age&gt;<span class="number">20</span>,User.age&lt;<span class="number">25</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(users))</span><br><span class="line">    users = User.query.<span class="built_in">filter</span>(User.name.contains(<span class="string">&#x27;3&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(users))</span><br><span class="line">    users = User.query.<span class="built_in">filter</span>(User.name.in_([<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(users))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;success !&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># paginate 对象，在网页中/paginate/？后加的参数 page=1 就是第一页的内容。</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/paginate/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_paginate</span>():</span><br><span class="line">    <span class="comment"># 默认显示第一页</span></span><br><span class="line">    page = <span class="built_in">int</span>(request.args.get(<span class="string">&#x27;page&#x27;</span>,<span class="number">1</span>))</span><br><span class="line">    <span class="comment"># 每页显示数据量</span></span><br><span class="line">    per_page = <span class="built_in">int</span>(request.args.get(<span class="string">&#x27;per_page&#x27;</span>,<span class="number">5</span>))</span><br><span class="line">    <span class="built_in">print</span>(page,<span class="built_in">type</span>(page))</span><br><span class="line">    <span class="built_in">print</span>(per_page,<span class="built_in">type</span>(per_page))</span><br><span class="line">    <span class="comment"># 下面的只是默认形参，实际以网页输入的参数为准。</span></span><br><span class="line">    p = User.query.paginate(page=page,per_page=per_page,error_out=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(p.items) <span class="comment"># 返回当前页的内容列表</span></span><br><span class="line">    <span class="built_in">print</span>(p.has_next) <span class="comment"># 是否有下一页</span></span><br><span class="line">    <span class="built_in">print</span>(p.has_prev)</span><br><span class="line">    <span class="built_in">print</span>(p.total)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;paginate.html&#x27;</span>,p=p)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># model.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .exts <span class="keyword">import</span> db </span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(db.Model):</span><br><span class="line">    <span class="comment"># 表名</span></span><br><span class="line">    __tablename__ = <span class="string">&#x27;user1&#x27;</span></span><br><span class="line">    <span class="comment"># 定义表的字段 </span></span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer,primary_key=<span class="literal">True</span>,autoincrement=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">30</span>),unique=<span class="literal">True</span>)</span><br><span class="line">    age = db.Column(db.Integer,default=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>: <span class="comment"># 内置字符串函数</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>先去bootstrap官网下载文件，把对应的bootstrap.css 文件放到app&#x2F;static&#x2F;css文件夹下。照着文档指导配合自己的逻辑关系写即可。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- paginate.html&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="comment">&lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="comment">&lt;head&gt;</span></span><br><span class="line"><span class="comment">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="comment">    &lt;title&gt;分页演示&lt;/title&gt;</span></span><br><span class="line"><span class="comment">    &lt;!-- 先去bootstrp官网下载对应的css文件。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;,filename=&#x27;css/bootstrap.css&#x27;)&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>分页演示<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 编程的方式插入具体的内容 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;list-group&quot;</span>&gt;</span>  </span><br><span class="line">            &#123;% for user in p.items %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;list-group-item&quot;</span>&gt;</span>&#123;&#123; user.name &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>    </span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加上页脚 也就是分页内容 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;pagination&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 上一页 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;page-item&quot;</span>&gt;</span></span><br><span class="line">            &#123;% if p.has_prev %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;page-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/paginate/?page=&#123;&#123; p.prev_num &#125;&#125;&amp;per_page=3&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Previous&quot;</span>&gt;</span></span><br><span class="line">            &#123;% else %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;page-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Previous&quot;</span>&gt;</span></span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="symbol">&amp;laquo;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 中间页码 --&gt;</span></span><br><span class="line">        &#123;% for i in range(p.pages) %&#125;   </span><br><span class="line">            &#123;% if p.page == i+1 %&#125; <span class="comment">&lt;!-- 标亮当前页面 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;page-item active&quot;</span>&gt;</span></span><br><span class="line">            &#123;% else %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;page-item&quot;</span>&gt;</span></span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">            <span class="comment">&lt;!-- &lt;li class=&quot;page-item&quot;&gt; --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;page-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/paginate/?page=&#123;&#123; i+1 &#125;&#125;&amp;per_page=3&quot;</span>&gt;</span>&#123;&#123; i + 1 &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">        <span class="comment">&lt;!-- 下一页 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;page-item&quot;</span>&gt;</span></span><br><span class="line">            &#123;% if p.has_next %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;page-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/paginate/?page=&#123;&#123; p.next_num &#125;&#125;&amp;per_page=3&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Next&quot;</span>&gt;</span></span><br><span class="line">            &#123;% else %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;page-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Next&quot;</span>&gt;</span></span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="symbol">&amp;raquo;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="图书馆测试项目"><a href="#图书馆测试项目" class="headerlink" title="图书馆测试项目"></a>图书馆测试项目</h1><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2008.45.02.jpg" alt="截屏2024-02-28 08.45.02"></p>
<p>app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接从App包 下调用 __init__.py 中的方法创建app对象就 好了。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> App <span class="keyword">import</span> create_app </span><br><span class="line"><span class="keyword">from</span> App.models <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">app = create_app()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p><code>__init__.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入上一层级的 App 的包的时候，这个 __init__.py自动执行</span></span><br><span class="line"><span class="comment"># 一个 App 就是一个 flask 应用。</span></span><br><span class="line"><span class="comment"># 注意不要循环导入，这里统一外部向 __init__ 导入；</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask </span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> blue</span><br><span class="line"><span class="keyword">from</span> .exts <span class="keyword">import</span> init_exts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不必每一次 导入app包都新建一个 app 对象，所以封装进方法等待调用。jdong</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_app</span>():</span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 给app对象 注册 blue蓝图，把他们关联上。</span></span><br><span class="line">    app.register_blueprint(blueprint=blue)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 配置数据库</span></span><br><span class="line">    <span class="comment"># db_uri = &#x27;sqlite:///sqlite3.db&#x27;</span></span><br><span class="line">    db_uri = <span class="string">&#x27;mysql+pymysql://root:cys123456@localhost:3306/bookdb&#x27;</span> <span class="comment"># mysql</span></span><br><span class="line">    app.config[<span class="string">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = db_uri <span class="comment"># 配置数据库路径</span></span><br><span class="line">    app.config[<span class="string">&#x27;SQLALCHEMY_TRACK_MODIFICATIONS&#x27;</span>] = <span class="literal">False</span> </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 把 插件和app关联上</span></span><br><span class="line">    init_exts(app=app)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> app </span><br></pre></td></tr></table></figure>

<p>exes.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">from</span> flask_migrate <span class="keyword">import</span> Migrate</span><br><span class="line"></span><br><span class="line">db = SQLAlchemy() </span><br><span class="line">migrate = Migrate()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_exts</span>(<span class="params">app</span>):</span><br><span class="line">    db.init_app(app=app)</span><br><span class="line">    migrate.init_app(app=app,db=db)</span><br></pre></td></tr></table></figure>

<p>models.py 定义模型结构</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> .exts <span class="keyword">import</span> db </span><br><span class="line"></span><br><span class="line"><span class="comment"># 作者 </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Author</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer,primary_key=<span class="literal">True</span>,autoincrement=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">20</span>) )</span><br><span class="line">    age = db.Column(db.Integer,default=<span class="number">1</span>)</span><br><span class="line">    sex = db.Column(db.Boolean,default=<span class="literal">True</span>) </span><br><span class="line">    email = db.Column(db.String(<span class="number">200</span>))</span><br><span class="line">    <span class="comment"># 关系 (关联上book表) 1对多</span></span><br><span class="line">    <span class="comment"># 如果要知道 一个作者有多少作品，Author.books 关联的表book调用backref的值可以知道对应的作者。</span></span><br><span class="line">    books = db.relationship(<span class="string">&#x27;Book&#x27;</span>,backref=<span class="string">&#x27;auther&#x27;</span>,lazy=<span class="string">&#x27;dynamic&#x27;</span>)  </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 书籍</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer,primary_key=<span class="literal">True</span>,autoincrement=<span class="literal">True</span>)</span><br><span class="line">    title = db.Column(db.String(<span class="number">100</span>),unique=<span class="literal">True</span>)</span><br><span class="line">    date = db.Column(db.DateTime)</span><br><span class="line">    <span class="comment"># 1对多，外键。</span></span><br><span class="line">    author_id = db.Column(db.Integer,db.ForeignKey(Author.<span class="built_in">id</span>)) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 中间表 (书籍-出版社) 如果关联中间表，则需要 secondary 参数</span></span><br><span class="line"><span class="comment"># 设置这两个字段为主键的目的是确保在中间表中的每一对关系都是唯一的</span></span><br><span class="line">book_publisher = db.Table(<span class="string">&#x27;book_publisher&#x27;</span>,</span><br><span class="line">    db.Column(<span class="string">&#x27;book_id&#x27;</span>,db.Integer,db.ForeignKey(<span class="string">&#x27;book.id&#x27;</span>),primary_key=<span class="literal">True</span>),</span><br><span class="line">    db.Column(<span class="string">&#x27;publisher_id&#x27;</span>,db.Integer,db.ForeignKey(<span class="string">&#x27;publisher.id&#x27;</span>),primary_key=<span class="literal">True</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 出版社</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Publisher</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer,primary_key=<span class="literal">True</span>,autoincrement=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">20</span>),unique=<span class="literal">True</span>)</span><br><span class="line">    address = db.Column(db.String(<span class="number">200</span>))</span><br><span class="line">    province = db.Column(db.String(<span class="number">100</span>))</span><br><span class="line">    country = db.Column(db.String(<span class="number">100</span>))</span><br><span class="line">    website = db.Column(db.String(<span class="number">100</span>))</span><br><span class="line">    <span class="comment"># 多对多，关联book表。</span></span><br><span class="line">    <span class="comment"># 出版社调用 books 可以知道出版社对应的书籍，某一本书调用backref的值知道对应出版社。</span></span><br><span class="line">    books = db.relationship(<span class="string">&#x27;Book&#x27;</span>,backref=<span class="string">&#x27;publishers&#x27;</span>,</span><br><span class="line">                            secondary=book_publisher,lazy=<span class="string">&#x27;dynamic&#x27;</span>)    </span><br></pre></td></tr></table></figure>

<p>模型构建好以后，就可以进入 app.py 文件夹所在的目录，执行</p>
<p><code>flask db init（创建迁移文件夹migrates;只调用一次）  </code><br><code>flask db migrate (生成迁移文件;自动搜索继承了db.Model的类) </code><br><code>flask db upgrade (把类都转换成表)  </code><br><code>flask db downgrade (撤回把类都转换成表)</code></p>
<p>构建完表之后，就可以往表内写各种内容了。如果是vscode插件操作mysql可能出现数据库同步出现问题，此时需要找到migrations文件夹下最下面也就是最新的一个.py文件的名称，此名称去掉下划线，放入mysql数据库的alembic_version中。</p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2008.59.23.jpg" alt="截屏2024-02-28 08.59.23"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2008.58.37.jpg" alt="截屏2024-02-28 08.58.37"></p>
<p>​		通过模型让mysql构建好表的结构之后，我们在表内写入数据。</p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2009.02.36.jpg" alt="截屏2024-02-28 09.02.36"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2009.02.56.jpg" alt="截屏2024-02-28 09.02.56"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2009.03.31.jpg" alt="截屏2024-02-28 09.03.31"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-28%2009.03.48.jpg" alt="截屏2024-02-28 09.03.48"></p>
<p>view.py 视图脚本,基于视图脚本写各个html的前端逻辑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> and_</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, render_template, request</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> desc </span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;book&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/bookindex/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">book_index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;book_index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/booklist/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">book_list</span>():</span><br><span class="line">    books = Book.query.<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;book_list.html&#x27;</span>,books = books)</span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/bookdetail/&lt;int:bid&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">book_detail</span>(<span class="params">bid</span>):</span><br><span class="line">    book = Book.query.get(bid)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;book_detail.html&#x27;</span>,book=book)</span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/authordetail/&lt;int:aid&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">author_detail</span>(<span class="params">aid</span>):</span><br><span class="line">    author = Author.query.get(aid)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;author_detail.html&#x27;</span>,author=author)</span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/publisherdetail/&lt;int:pid&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">publisher_detail</span>(<span class="params">pid</span>):</span><br><span class="line">    publisher = Publisher.query.get(pid)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;publisher_detail.html&#x27;</span>,publisher=publisher)</span><br></pre></td></tr></table></figure>

<p>book_index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>书籍<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>书籍首页<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/booklist/&quot;</span>&gt;</span>查看所有书籍<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>book_list.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>书籍<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>书籍列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        &#123;% for book in books %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- &lt;a href=&quot;/bookdetail/&#123;&#123; book.id &#125;&#125;&quot;&gt;&#123;&#123; book.title &#125;&#125;&lt;/a&gt; --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;book.book_detail&#x27;,bid=book.id) &#125;&#125;&quot;</span>&gt;</span>&#123;&#123; book.title &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>book_detail.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>书籍<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>书籍详情<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>书籍标题：&#123;&#123; book.title &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>书籍出版时间：&#123;&#123; book.date &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>作者：</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/authordetail/&#123;&#123; book.auther.id &#125;&#125;&quot;</span>&gt;</span>&#123;&#123; book.auther.name &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>出版社：</span><br><span class="line">        &#123;% for publisher in book.publishers %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/publisherdetail/&#123;&#123; publisher.id &#125;&#125;&quot;</span>&gt;</span>&#123;&#123; publisher.name &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>author_detail.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>书籍<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>作者详情<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>作者名称：&#123;&#123; author.name &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>作者年龄：&#123;&#123; author.age &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>作者性别：&#123;&#123; author.sex &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>作者Email：&#123;&#123; author.email &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>我的作品</span><br><span class="line">        &#123;% for book in author.books %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/bookdetail/&#123;&#123; book.id &#125;&#125;&quot;</span>&gt;</span>&#123;&#123; book.title &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>publisher_detail.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>书籍<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>出版社详情<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>出版社名称：&#123;&#123; publisher.name &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>出版社名称：&#123;&#123; publisher.address &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>出版社名称：&#123;&#123; publisher.city &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>出版社名称：&#123;&#123; publisher.province &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>出版社名称：&#123;&#123; publisher.website &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>出版社的出版书籍</span><br><span class="line">        &#123;% for book in publisher.books %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/bookdetail/&#123;&#123; book.id &#125;&#125;&quot;</span>&gt;</span>&#123;&#123; book.title &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="插件使用"><a href="#插件使用" class="headerlink" title="插件使用"></a>插件使用</h1><h2 id="缓存例子"><a href="#缓存例子" class="headerlink" title="缓存例子"></a>缓存例子</h2><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-29%2009.35.45.jpg" alt="截屏2024-02-29 09.35.45"></p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-02-29%2009.42.04.jpg" alt="截屏2024-02-29 09.42.04"></p>
<p>​		使用flask插件 就三个步骤，先下载，再ext.py中初始化，最后再视图中使用。</p>
<p>​		</p>
<h1 id="中间件（钩子）"><a href="#中间件（钩子）" class="headerlink" title="中间件（钩子）"></a>中间件（钩子）</h1><h2 id="切面编程"><a href="#切面编程" class="headerlink" title="切面编程"></a>切面编程</h2><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-03-01%2010.56.21.jpg" alt="截屏2024-03-01 10.56.21"></p>
<p>views.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> and_</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, render_template, request</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> desc </span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> .exts <span class="keyword">import</span> cache </span><br><span class="line"></span><br><span class="line"><span class="comment"># 蓝图用于规划 url</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;book&#x27;</span>,__name__) <span class="comment"># __name__表示导入到当前模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用缓存</span></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@cache.cached(<span class="params">timeout=<span class="number">20</span></span>) </span><span class="comment"># 给视图函数加上 20 秒的缓存。第一次打开要等5秒，20s内再打开是秒开的，因为有缓存。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;index111&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Index&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;index&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x27;&#x27;&#x27;切面编程&#x27;&#x27;&#x27;———————————————————————————————————————————————————</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 中间件函数</span></span><br><span class="line"><span class="comment"># 每一次请求之前都会使用。</span></span><br><span class="line"><span class="meta">@blue.before_request</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">before</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;before request.&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(request.path)</span><br><span class="line">    <span class="built_in">print</span>(request.method)</span><br><span class="line">    <span class="built_in">print</span>(request.remote_addr) <span class="comment"># 客户端的IP</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># # 简单反爬</span></span><br><span class="line">    <span class="comment"># # 识别出爬虫 python-requests/2.31.0</span></span><br><span class="line">    <span class="comment"># # 正常浏览器访问  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit...</span></span><br><span class="line">    <span class="comment"># print(request.user_agent) </span></span><br><span class="line">    <span class="comment"># if &#x27;python&#x27; in request.user_agent.string:</span></span><br><span class="line">    <span class="comment">#     return &#x27;检查出爬虫。&#x27; # 这个会被返回到爬虫运行者那边。</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 针对IP做反爬  简单</span></span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="comment"># 获取到了IP，如果这个IP之前就有缓存，直接返回 拦截。</span></span><br><span class="line">    <span class="keyword">if</span> cache.get(ip):</span><br><span class="line">        <span class="comment"># 做好拦截，进入视图函数。</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;please stop 爬虫!!!&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 如果这个IP之前没有缓存，对每个IP设置缓存，1秒内不能多次重复访问。</span></span><br><span class="line">        cache.<span class="built_in">set</span>(ip,<span class="string">&#x27;value&#x27;</span>,timeout=<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># &#x27;&#x27;&#x27;切面编程&#x27;&#x27;&#x27;—————————————————————————————————————————————————</span></span><br></pre></td></tr></table></figure>

<p>spider.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests </span><br><span class="line"></span><br><span class="line">res = requests.get(<span class="string">&#x27;http://127.0.0.1:5000/&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res.text) </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):  <span class="comment"># 故意测试一下。</span></span><br><span class="line">    res = requests.get(<span class="string">&#x27;http://127.0.0.1:5000/&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>



<h1 id="flask四大内置对象"><a href="#flask四大内置对象" class="headerlink" title="flask四大内置对象"></a>flask四大内置对象</h1><p><strong>g</strong>：global，突破变量存储位置限制，例如在 before_request装饰的钩子函数产生了一个后续用得到的变量就可以保存在g对象中，在视图函数中就可以用这个数据。</p>
<p><strong>request</strong>：请求对象，可以获取客户端提交过来的请求信息。</p>
<p><strong>session</strong>：会话技术，服务端会话技术的接口。</p>
<p><strong>current_app</strong>：app的配置信息，app对象获取，一定要在初始化之后使用。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g<span class="selector-class">.star</span> = <span class="string">&#x27;jack&#x27;</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(current_app)</span></span></span><br></pre></td></tr></table></figure>



<h1 id="静态文件目录static和模版文件目录templates"><a href="#静态文件目录static和模版文件目录templates" class="headerlink" title="静态文件目录static和模版文件目录templates"></a>静态文件目录static和模版文件目录templates</h1><p>​		需要去 Flask.py文件中去修改，才能变 templates的配置。但是我们不推荐在这里改。<img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-08-25%2020.40.41.jpg" alt="截屏2024-08-25 20.40.41"></p>
<p>​		给一个改动的例子，把app文件下的 static 和 templates 改到外面一层的文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 __init__</span></span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__))) <span class="comment"># 本文件的绝对路径的所在文件夹的所在文件夹，就是 上一层的文件夹。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_app</span>():</span><br><span class="line">  static_folder = os.path.join(BASE_DIR,<span class="string">&#x27;static&#x27;</span>)</span><br><span class="line">  template_folder = os.path.join(BASE_DIR,<span class="string">&#x27;template&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">  app = Flask(__name__,static_folder=static_folder,</span><br><span class="line">             template_folder=template_folder)  <span class="comment"># 改位置。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="前后端分离"><a href="#前后端分离" class="headerlink" title="前后端分离"></a>前后端分离</h1><p>​      <img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-08-29%2020.07.25.jpg" alt="截屏2024-08-29 20.07.25"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># views.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint,render_template,jsonify,request </span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># blue</span></span><br><span class="line">blue = Blueprint(<span class="string">&#x27;user&#x27;</span>,__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 前后端不分离</span></span><br><span class="line"><span class="comment">#       render_template(&#x27;index.html&#x27;,users=users)</span></span><br><span class="line"><span class="comment"># 前后端分离</span></span><br><span class="line"><span class="comment">#       后端返回 json 字符串  jsonify():</span></span><br><span class="line"><span class="comment">#       前端使用 ajax 来请求数据  ajax</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@blue.route(<span class="params"><span class="string">&#x27;/usres/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;PUT&#x27;</span>,<span class="string">&#x27;DELETE&#x27;</span>]</span>) </span><span class="comment"># 查 增 改 删</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">users</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;method&#x27;</span>:<span class="string">&#x27;GET&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;method&#x27;</span>:<span class="string">&#x27;POST&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;PUT&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;method&#x27;</span>:<span class="string">&#x27;PUT&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;DELETE&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;method&#x27;</span>:<span class="string">&#x27;DELETE&#x27;</span>&#125;)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">res = requests.get(<span class="string">&#x27;http://127.0.0.1:5000/usres/&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line"></span><br><span class="line">res = requests.post(<span class="string">&#x27;http://127.0.0.1:5000/usres/&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>





<h1 id="Flask类视图和RESTful"><a href="#Flask类视图和RESTful" class="headerlink" title="Flask类视图和RESTful"></a>Flask类视图和RESTful</h1><p>​		我们删除 view模块，新建一个 apis.py模块，对 上面的代码 修改，使用 api接口开发。<br>之前用路由修饰器来访问到视图函数，现在该用单独的一个urls.py模块（路游文件）来实现访问视图函数。 restful 封装了查 增 改 删</p>
<p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-09-10%2014.50.54.jpg" alt="截屏2024-09-10 14.50.54"></p>
<p>​		先说一下 思路，就是在 exts模块中引入restful包的api，然后在 写入exts的初始化的方法中，在初始化的时候把 app对象 和 这个插件api 对象绑定，把我们想要写的逻辑写进一个名叫 apis的模块的 函数中（充当视图函数），新建一个 urls模块 作路由用，这个路由模块中需要 关联上 apis模块中我们的逻辑 和 插件api对象，让索引能够找到 我们apis模块中 视图函数。（但是请在__init__模块中import 一下，不然urls模块不会执行）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exts.py</span></span><br><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"><span class="keyword">from</span> flask_migrate <span class="keyword">import</span> Migrate</span><br><span class="line"><span class="keyword">from</span> flask_restful <span class="keyword">import</span> Api</span><br><span class="line"></span><br><span class="line">db = SQLAlchemy() </span><br><span class="line">migrate = Migrate()</span><br><span class="line">api = Api()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_exts</span>(<span class="params">app</span>):</span><br><span class="line">    db.init_app(app=app)</span><br><span class="line">    migrate.init_app(app=app,db=db)</span><br><span class="line">    api.init_app(app=app)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apis.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br><span class="line"><span class="keyword">from</span> flask_restful <span class="keyword">import</span> Resource</span><br><span class="line"></span><br><span class="line"><span class="comment"># 类视图 CBV class based view</span></span><br><span class="line"><span class="comment"># 视图函数 FBV function based view </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HelloResouce</span>(<span class="title class_ inherited__">Resource</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;get 请求&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;post 请求&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># urls.py</span></span><br><span class="line"><span class="comment"># urls.py 路由文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .exts <span class="keyword">import</span> api</span><br><span class="line"><span class="keyword">from</span> .apis <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 路由</span></span><br><span class="line">api.add_resource(HelloResouce,<span class="string">&#x27;/hello/&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="字段格式化及参数解析"><a href="#字段格式化及参数解析" class="headerlink" title="字段格式化及参数解析"></a>字段格式化及参数解析</h1><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-09-19%2014.47.35.jpg" alt="截屏2024-09-19 14.47.35"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># apis.py</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br><span class="line"><span class="keyword">from</span> flask_restful <span class="keyword">import</span> Resource,fields,marshal_with,reqparse</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 类视图 CBV class based view</span></span><br><span class="line"><span class="comment"># 视图函数 FBV function based view </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HelloResouce</span>(<span class="title class_ inherited__">Resource</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;get 请求&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;post 请求&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------------------------  字段格式化 ------------------------------ </span></span><br><span class="line"><span class="comment"># 定义返回给前端的数据格式</span></span><br><span class="line"><span class="comment"># flask-restful</span></span><br><span class="line"><span class="comment"># 一个字典，定义格式化，定义返回给前端的数据格式</span></span><br><span class="line">ret_field = &#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>:fields.Integer,</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>:fields.String,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>:fields.Integer,</span><br><span class="line">    <span class="comment"># &#x27;status&#x27;:fields.Integer,</span></span><br><span class="line">    <span class="comment"># &#x27;msg&#x27;:fields.String,</span></span><br><span class="line">    <span class="comment">#  &#x27;go&#x27;:fields.String,</span></span><br><span class="line">    <span class="comment">#  &#x27;data&#x27;:fields.String,</span></span><br><span class="line">    <span class="string">&#x27;like&#x27;</span>:fields.String(default=<span class="string">&#x27;ball&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;url&#x27;</span>:fields.Url(endpoint=<span class="string">&#x27;id&#x27;</span>,absolute=<span class="literal">True</span>) <span class="comment">#  显示路由绝对路径。在urls模块中 endpoint在哪个路径，这里就会显示谁的路径。</span></span><br><span class="line">    <span class="comment">#  &#x27;data2&#x27;:fields.String(attribute=&#x27;data&#x27;) # 使用 data 的值。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserResource</span>(<span class="title class_ inherited__">Resource</span>):</span><br><span class="line"><span class="meta">    @marshal_with(<span class="params">ret_field</span>)  </span><span class="comment"># 把 对应的方法 通过这个装饰器 和 格式化定义关联上。</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;data&#x27;</span>:<span class="string">&#x27;chenyushao&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">ret_field2 = &#123;</span><br><span class="line">    <span class="string">&#x27;status&#x27;</span>:fields.Integer,</span><br><span class="line">    <span class="string">&#x27;msg&#x27;</span>:fields.String,</span><br><span class="line">    <span class="comment"># user 对象</span></span><br><span class="line">    <span class="string">&#x27;data&#x27;</span>:fields.Nested(ret_field) <span class="comment"># 调用 其他的 格式化要求。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User2Resource</span>(<span class="title class_ inherited__">Resource</span>):</span><br><span class="line"><span class="meta">    @marshal_with(<span class="params">ret_field2</span>)  </span><span class="comment"># 把 对应的方法 通过这个装饰器 和 格式化定义关联上。</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self</span>):</span><br><span class="line">        user = User.query.first() <span class="comment"># 从数据库表中读第一行。</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;data&#x27;</span>:user</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------------------------  字段格式化 ------------------------------ </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ret_field3 = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>:fields.String,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>:fields.Integer,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ret_field4 = &#123;</span><br><span class="line">    <span class="string">&#x27;status&#x27;</span>:fields.Integer,</span><br><span class="line">    <span class="string">&#x27;msg&#x27;</span>:fields.String,</span><br><span class="line">    <span class="comment"># user 对象</span></span><br><span class="line">    <span class="string">&#x27;data&#x27;</span>:fields.<span class="type">List</span>(fields.Nested(ret_field3)) <span class="comment"># 调用 其他的 格式化要求。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User3Resource</span>(<span class="title class_ inherited__">Resource</span>):</span><br><span class="line"><span class="meta">    @marshal_with(<span class="params">ret_field4</span>)  </span><span class="comment"># 把 对应的方法 通过这个装饰器 和 格式化定义关联上。</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self</span>):</span><br><span class="line">        user = User.query.first() <span class="comment"># 从数据库表中读第一行。</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;data&#x27;</span>:user</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment"># ------------------------------  字段格式化 ------------------------------ </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------------------------  参数解析 -------------------------------- </span></span><br><span class="line"><span class="comment"># 解析前端发送过来的数据</span></span><br><span class="line">parser = reqparse.RequestParser() </span><br><span class="line"><span class="comment"># 给parser 作一个规范声明，name 是提交过来的参数名称，类型，是否必须，没提交的提示 help。</span></span><br><span class="line">parser.add_argument(<span class="string">&#x27;name&#x27;</span>,<span class="built_in">type</span>=<span class="built_in">str</span>,required=<span class="literal">True</span>,<span class="built_in">help</span>=<span class="string">&#x27;name是必须的参数。&#x27;</span>) </span><br><span class="line">parser.add_argument(<span class="string">&#x27;age&#x27;</span>,<span class="built_in">type</span>=<span class="built_in">int</span>,required=<span class="literal">True</span>,action=<span class="string">&#x27;append&#x27;</span>) <span class="comment"># append支持多个age的意思 </span></span><br><span class="line"><span class="comment"># 随便从百度的网页的network 中 fetch 里， 点一下页面，找一个请求头的Cookes 来示范。</span></span><br><span class="line">parser.add_argument(<span class="string">&#x27;BAIDUID&#x27;</span>,<span class="built_in">type</span>=<span class="built_in">str</span>,location=<span class="string">&#x27;cookies&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User4Resource</span>(<span class="title class_ inherited__">Resource</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 获取参数</span></span><br><span class="line">        args = parser.parse_args()</span><br><span class="line">        name = args.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">        age = args.get(<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line">        BAIDUID = args.get(<span class="string">&#x27;BAIDUID&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;name&#x27;</span>:name,<span class="string">&#x27;age&#x27;</span>:age,<span class="string">&#x27;BAIDUID&#x27;</span>:BAIDUID&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------------------------  参数解析 -------------------------------- </span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># spider.py 单独运行这个 脚本来模仿 爬虫的访问。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># res = requests.get(&#x27;http://127.0.0.1:5000/hello/&#x27;)</span></span><br><span class="line"><span class="comment"># print(res.json())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># res = requests.post(&#x27;http://127.0.0.1:5000/usres/&#x27;)</span></span><br><span class="line"><span class="comment"># print(res.text)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据返回的提示改的 请求需求。  </span></span><br><span class="line">res = requests.get(<span class="string">&#x27;http://127.0.0.1:5000/user4/&#x27;</span>,</span><br><span class="line">                    json=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;lisi&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="string">&#x27;30&#x27;</span>&#125;,</span><br><span class="line">                    headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;Cookie&#x27;</span>:<span class="string">&#x27;BAIDUID=DBF491F84E3AC8F568BC6F6E3D8DF37C&#x27;</span></span><br><span class="line">                    &#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>







<h1 id="实验部分"><a href="#实验部分" class="headerlink" title="实验部分"></a>实验部分</h1><p><img src="/2025/05/20/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/flask_study/%E6%88%AA%E5%B1%8F2024-09-19%2015.33.52.jpg" alt="截屏2024-09-19 15.33.52"></p>
<h2 id="项目分析"><a href="#项目分析" class="headerlink" title="项目分析"></a>项目分析</h2><h2 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h2>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag"># 网络</a>
              <a href="/tags/flask/" rel="tag"># flask</a>
              <a href="/tags/%E5%90%8E%E7%AB%AF/" rel="tag"># 后端</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/05/18/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/huggingface%E5%AE%89%E8%A3%85%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B/" rel="prev" title="huggingface安装安全模型">
                  <i class="fa fa-chevron-left"></i> huggingface安装安全模型
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/05/28/%E5%8C%BA%E5%9D%97%E9%93%BE/%E5%A4%A7%E9%99%86%E4%BD%BF%E7%94%A8okx%E6%8E%A5%E5%8F%A3/" rel="next" title="大陆使用okx接口">
                  大陆使用okx接口 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">陈宇韶chenyushao</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
